<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>قائمة الطعام العراقي الفاخرة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/qrcode-svg@1.1.0/lib/qrcode.min.js"></script>
    <style>
        :root {
            --gold: #D4AF37;
            --dark-gold: #B8860B;
            --brown: #8B4513;
            --light-brown: #A0522D;
            --cream: #FFF8DC;
            --dark: #2C1810;
            --green: #228B22;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', 'El Messiri', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f8f4e9 0%, #f1e8d7 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        /* زر التحكم السري */
        .secret-control-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, var(--dark), var(--brown));
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .secret-control-btn:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, var(--brown), var(--dark));
        }

        /* نافذة التحكم السرية */
        .secret-control-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }

        .secret-control-modal.active {
            display: flex;
        }

        .secret-control-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            border: 3px solid var(--gold);
        }

        .password-section {
            text-align: center;
        }

        .password-section h3 {
            color: var(--dark);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--gold);
            border-radius: 15px;
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 20px;
            font-family: monospace;
            letter-spacing: 2px;
        }

        .password-btn {
            background: linear-gradient(135deg, var(--gold), var(--dark-gold));
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .password-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.3);
        }

        .error-message {
            color: #e74c3c;
            margin-top: 10px;
            font-size: 0.9rem;
            display: none;
        }

        /* لوحة التحكم الرئيسية */
        .control-panel {
            display: none;
        }

        .control-panel.active {
            display: block;
        }

        .control-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--cream);
            padding-bottom: 10px;
        }

        .control-tab {
            padding: 12px 25px;
            background: var(--cream);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            color: var(--brown);
            transition: all 0.3s ease;
        }

        .control-tab.active {
            background: linear-gradient(135deg, var(--gold), var(--dark-gold));
            color: white;
        }

        .control-section {
            display: none;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }

        .control-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            transition: border 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--gold);
            outline: none;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-control {
            flex: 1;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--gold), var(--dark-gold));
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.9rem;
        }

        .menu-items-list {
            margin-top: 20px;
        }

        .menu-item-control {
            background: var(--cream);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid transparent;
            transition: border 0.3s ease;
        }

        .menu-item-control:hover {
            border-color: var(--gold);
        }

        .menu-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        /* باقي الأنماط من الكود السابق */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 2px solid var(--gold);
        }

        .header {
            background: linear-gradient(90deg, var(--dark), var(--brown));
            color: white;
            padding: 30px 40px;
            text-align: center;
            border-bottom: 5px solid var(--gold);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .logo i {
            font-size: 3rem;
            color: var(--gold);
        }

        .restaurant-name {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .tagline {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .info-bar {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
        }

        .info-item i {
            color: var(--gold);
        }

        .tabs {
            display: flex;
            justify-content: center;
            background: var(--cream);
            padding: 20px;
            gap: 15px;
            flex-wrap: wrap;
            border-bottom: 2px solid rgba(139, 69, 19, 0.1);
        }

        .tab {
            padding: 15px 30px;
            background: white;
            border: 2px solid var(--gold);
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--brown);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.2);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--gold), var(--dark-gold));
            color: white;
            border-color: var(--gold);
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            padding: 40px;
        }

        .menu-item {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid rgba(139, 69, 19, 0.1);
            transition: all 0.3s ease;
        }

        .menu-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .item-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-bottom: 3px solid var(--gold);
            background: linear-gradient(45deg, #f8f4e9, #f1e8d7);
        }

        .item-content {
            padding: 25px;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .item-name {
            font-size: 1.6rem;
            color: var(--dark);
            font-weight: 700;
            flex: 1;
            margin-left: 15px;
        }

        .item-price {
            background: linear-gradient(135deg, var(--gold), var(--dark-gold));
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 1.5rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
        }

        .currency {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .item-desc {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .item-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag {
            background: rgba(139, 69, 19, 0.1);
            color: var(--brown);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--green);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            z-index: 2;
        }

        .image-container {
            position: relative;
        }

        .qr-section {
            background: linear-gradient(135deg, var(--dark), var(--brown));
            color: white;
            padding: 40px;
            margin: 40px;
            border-radius: 20px;
            text-align: center;
        }

        .qr-section h3 {
            font-size: 2rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .qr-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        #qrcode {
            background: white;
            padding: 20px;
            border-radius: 15px;
            display: inline-block;
            min-width: 200px;
            min-height: 200px;
        }

        .qr-info {
            text-align: right;
            max-width: 400px;
        }

        .qr-info p {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .link-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: monospace;
            word-break: break-all;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .link-box:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        footer {
            background: var(--cream);
            padding: 30px 40px;
            text-align: center;
            border-top: 2px solid var(--gold);
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-col h4 {
            color: var(--brown);
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .stars {
            color: var(--gold);
            font-size: 1.2rem;
            margin-top: 10px;
        }

        .copyright {
            color: #666;
            padding-top: 20px;
            border-top: 1px solid rgba(139, 69, 19, 0.2);
        }

        .copy-btn {
            background: linear-gradient(135deg, var(--gold), var(--dark-gold));
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }

        .copy-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
        }

        @media (max-width: 768px) {
            .container {
                border-radius: 15px;
            }
            
            .restaurant-name {
                font-size: 2.2rem;
            }
            
            .menu-grid {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            
            .qr-section {
                margin: 20px;
                padding: 30px 20px;
            }
            
            .qr-container {
                flex-direction: column;
                gap: 20px;
            }
            
            .tabs {
                padding: 15px;
            }
            
            .tab {
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .item-name {
                margin-left: 0;
            }
            
            .secret-control-content {
                padding: 20px;
                width: 95%;
            }
            
            .form-row {
                flex-direction: column;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- زر التحكم السري -->
    <button class="secret-control-btn" onclick="openSecretControl()">
        <i class="fas fa-user-secret"></i>
    </button>

    <!-- نافذة التحكم السرية -->
    <div class="secret-control-modal" id="secretControlModal">
        <div class="secret-control-content">
            <div class="password-section" id="passwordSection">
                <h3><i class="fas fa-lock"></i> الدخول إلى لوحة التحكم</h3>
                <input type="password" class="password-input" id="passwordInput" placeholder="أدخل كلمة المرور">
                <button class="password-btn" onclick="checkPassword()">
                    <i class="fas fa-sign-in-alt"></i> دخول
                </button>
                <div class="error-message" id="passwordError">كلمة المرور غير صحيحة!</div>
            </div>
            
            <div class="control-panel" id="controlPanel">
                <div class="control-tabs">
                    <button class="control-tab active" onclick="showControlTab('restaurant')">المطعم</button>
                    <button class="control-tab" onclick="showControlTab('menu')">الأصناف</button>
                    <button class="control-tab" onclick="showControlTab('qr')">الباركود</button>
                    <button class="control-tab" onclick="showControlTab('categories')">الأقسام</button>
                </div>
                
                <!-- قسم تعديل معلومات المطعم -->
                <div class="control-section active" id="restaurantControl">
                    <div class="form-group">
                        <label>اسم المطعم:</label>
                        <input type="text" class="form-control" id="controlRestaurantName" placeholder="اسم المطعم">
                    </div>
                    <div class="form-group">
                        <label>الشعار:</label>
                        <input type="text" class="form-control" id="controlTagline" placeholder="شعار المطعم">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>رقم الهاتف:</label>
                            <input type="text" class="form-control" id="controlPhone" placeholder="رقم الهاتف">
                        </div>
                        <div class="form-group">
                            <label>العنوان:</label>
                            <input type="text" class="form-control" id="controlLocation" placeholder="العنوان">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>أوقات العمل:</label>
                            <input type="text" class="form-control" id="controlHours" placeholder="أوقات العمل">
                        </div>
                        <div class="form-group">
                            <label>خدمة التوصيل:</label>
                            <input type="text" class="form-control" id="controlDelivery" placeholder="التوصيل">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="saveRestaurantInfo()">
                        <i class="fas fa-save"></i> حفظ معلومات المطعم
                    </button>
                </div>
                
                <!-- قسم تعديل الأصناف -->
                <div class="control-section" id="menuControl">
                    <div class="form-group">
                        <label>العملة:</label>
                        <input type="text" class="form-control" id="controlCurrency" placeholder="مثال: د.ع">
                    </div>
                    <div id="menuItemsList" class="menu-items-list">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                    <button class="btn btn-primary" onclick="addNewMenuItem()">
                        <i class="fas fa-plus"></i> إضافة صنف جديد
                    </button>
                    <button class="btn btn-secondary" onclick="saveMenuItems()" style="margin-top: 10px;">
                        <i class="fas fa-save"></i> حفظ جميع الأصناف
                    </button>
                </div>
                
                <!-- قسم الباركود -->
                <div class="control-section" id="qrControl">
                    <div class="form-group">
                        <label>رابط القائمة الإلكترونية:</label>
                        <input type="url" class="form-control" id="controlMenuUrl" placeholder="https://example.com/menu">
                    </div>
                    <button class="btn btn-primary" onclick="updateQRCode()">
                        <i class="fas fa-qrcode"></i> تحديث الباركود
                    </button>
                    <div style="margin-top: 20px; padding: 15px; background: var(--cream); border-radius: 10px;">
                        <p><strong>ملاحظة:</strong> بعد تغيير الرابط، يجب مسح الباركود القديم واستخدام الجديد</p>
                    </div>
                </div>
                
                <!-- قسم الأقسام -->
                <div class="control-section" id="categoriesControl">
                    <div id="categoriesList" class="menu-items-list">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                    <button class="btn btn-primary" onclick="addNewCategory()">
                        <i class="fas fa-plus"></i> إضافة قسم جديد
                    </button>
                    <button class="btn btn-secondary" onclick="saveCategories()" style="margin-top: 10px;">
                        <i class="fas fa-save"></i> حفظ الأقسام
                    </button>
                </div>
                
                <div style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
                    <button class="btn btn-secondary" onclick="closeControlPanel()">
                        <i class="fas fa-times"></i> إغلاق لوحة التحكم
                    </button>
                    <button class="btn btn-danger" onclick="resetToDefault()" style="float: left;">
                        <i class="fas fa-undo"></i> إعادة التعيين
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- القائمة الرئيسية -->
    <div class="container">
        <header class="header">
            <div class="logo">
                <i class="fas fa-crown"></i>
                <div>
                    <h1 class="restaurant-name" id="restaurantName">MK CENTER</h1>
                    <p class="tagline" id="tagline">أصالة الطعم العراقي مع لمسة عصرية</p>
                </div>
            </div>
            <div class="info-bar">
                <div class="info-item">
                    <i class="fas fa-phone"></i>
                    <span id="phone">0770-123-4567</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span id="location">صلاح الدين -الدور</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-clock"></i>
                    <span id="hours">10:00 ص - 3:00 م</span>
                </div>
            </div>
        </header>

        <div class="tabs" id="tabsContainer"></div>

        <div class="menu-grid" id="menuContainer"></div>

        <div class="qr-section">
            <h3><i class="fas fa-qrcode"></i> القائمة الإلكترونية</h3>
            <p>امسح الباركود لعرض القائمة على هاتفك</p>
            <div class="qr-container">
                <div id="qrcode"></div>
                <div class="qr-info">
                    <p><i class="fas fa-link"></i> رابط القائمة:</p>
                    <div class="link-box" id="menuLinkText">https://baghdad-restaurant.com/menu</div>
                    <button class="copy-btn" onclick="copyMenuLink()">
                        <i class="fas fa-copy"></i> نسخ الرابط
                    </button>
                    <p><small>يمكن تحديث القائمة دون تغيير الباركود</small></p>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-grid">
                <div class="footer-col">
                    <h4><i class="fas fa-truck"></i> التوصيل</h4>
                    <p id="delivery">توصيل مجاني للطلبات فوق 25,000 دينار</p>
                </div>
                <div class="footer-col">
                    <h4><i class="fas fa-credit-card"></i> الدفع</h4>
                    <p>نقاط بيع - تحويل بنكي - كاش</p>
                </div>
                <div class="footer-col">
                    <h4><i class="fas fa-star"></i> تقييمنا</h4>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                        <span>4.7/5 (1,234 تقييم)</span>
                    </div>
                </div>
            </div>
            <p class="copyright">© 2024 MK CENTER. جميع الحقوق محفوظة.</p>
        </footer>
    </div>

    <script>
        // ========== بيانات افتراضية ==========
        const defaultRestaurantData = {
            name: "  MK CENTER",
            tagline: "أصالة الطعم العراقي مع لمسة عصرية",
            phone: "0770-123-4567",
            location: "صلاح الدين - الدور",
            hours: "10:00 ص - 3:00 م",
            delivery: "توصيل مجاني للطلبات فوق 25,000 دينار",
            currency: "د.ع",
            menuUrl: "https://baghdad-restaurant.com/menu",
            
            categories: [
                { id: "all", name: "كل الأصناف", icon: "fas fa-utensils" },
                { id: "main", name: "الأطباق الرئيسية", icon: "fas fa-drumstick-bite" },
                { id: "grills", name: "المشاوي", icon: "fas fa-fire" },
                { id: "appetizers", name: "المقبلات", icon: "fas fa-leaf" },
                { id: "desserts", name: "الحلويات", icon: "fas fa-ice-cream" },
                { id: "drinks", name: "المشروبات", icon: "fas fa-glass-whiskey" }
            ],
            
            menuItems: [
                {
                    id: 1,
                    name: "كبسة لحم ضأن",
                    description: "أرز بسمتي مع لحم ضأن طري وتوابل خاصة، تقدم مع صلصة الطماطم والمكسرات",
                    price: 35000,
                    image: "https://images.unsplash.com/photo-1589302168068-964664d93dc0?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    category: "main",
                    tags: ["الأكثر طلباً", "وجبة عائلية"],
                    badge: "الأفضل مبيعاً"
                },
                {
                    id: 2,
                    name: "قوزي",
                    description: "لحم ضأن كامل مع أرز ومكسرات وزبيب، مطهو على الطريقة التقليدية",
                    price: 75000,
                    image: "https://images.unsplash.com/photo-1563379091339-03246963d9d6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    category: "main",
                    tags: ["تقييم 5 نجوم", "مميز"],
                    badge: "وجبة فاخرة"
                }
            ]
        };

        // ========== إدارة البيانات ==========
        let restaurantData = { ...defaultRestaurantData };

        // تحميل البيانات المحفوظة
        function loadSavedData() {
            const saved = localStorage.getItem('restaurantMenuData');
            if (saved) {
                restaurantData = JSON.parse(saved);
            }
        }

        // حفظ البيانات
        function saveData() {
            localStorage.setItem('restaurantMenuData', JSON.stringify(restaurantData));
        }

        // ========== التحكم السري ==========
        function openSecretControl() {
            document.getElementById('secretControlModal').classList.add('active');
            document.getElementById('passwordSection').style.display = 'block';
            document.getElementById('controlPanel').style.display = 'none';
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordError').style.display = 'none';
        }

        function closeSecretControl() {
            document.getElementById('secretControlModal').classList.remove('active');
        }

        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            if (password === 'karam9') {
                document.getElementById('passwordSection').style.display = 'none';
                document.getElementById('controlPanel').style.display = 'block';
                document.getElementById('controlPanel').classList.add('active');
                loadControlData();
            } else {
                document.getElementById('passwordError').style.display = 'block';
                document.getElementById('passwordInput').value = '';
            }
        }

        function closeControlPanel() {
            closeSecretControl();
        }

        function showControlTab(tabName) {
            // إخفاء جميع الأقسام
            document.querySelectorAll('.control-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // إلغاء تفعيل جميع التبويبات
            document.querySelectorAll('.control-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // إظهار القسم المطلوب
            document.getElementById(tabName + 'Control').classList.add('active');
            
            // تفعيل التبويب المطلوب
            document.querySelectorAll('.control-tab').forEach(tab => {
                if (tab.textContent.includes(getTabTitle(tabName))) {
                    tab.classList.add('active');
                }
            });
        }

        function getTabTitle(tabName) {
            const titles = {
                'restaurant': 'المطعم',
                'menu': 'الأصناف',
                'qr': 'الباركود',
                'categories': 'الأقسام'
            };
            return titles[tabName] || tabName;
        }

        // ========== تحميل بيانات التحكم ==========
        function loadControlData() {
            // معلومات المطعم
            document.getElementById('controlRestaurantName').value = restaurantData.name;
            document.getElementById('controlTagline').value = restaurantData.tagline;
            document.getElementById('controlPhone').value = restaurantData.phone;
            document.getElementById('controlLocation').value = restaurantData.location;
            document.getElementById('controlHours').value = restaurantData.hours;
            document.getElementById('controlDelivery').value = restaurantData.delivery;
            document.getElementById('controlCurrency').value = restaurantData.currency;
            document.getElementById('controlMenuUrl').value = restaurantData.menuUrl;
            
            // تحميل الأصناف
            loadMenuItemsControl();
            
            // تحميل الأقسام
            loadCategoriesControl();
        }

        function loadMenuItemsControl() {
            const container = document.getElementById('menuItemsList');
            container.innerHTML = '';
            
            restaurantData.menuItems.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'menu-item-control';
                itemElement.innerHTML = `
                    <div class="menu-item-header">
                        <h4>${item.name}</h4>
                        <button class="btn btn-danger btn-small" onclick="deleteMenuItem(${index})">
                            <i class="fas fa-trash"></i> حذف
                        </button>
                    </div>
                    <div class="form-row">
                        <input type="text" class="form-control" value="${item.name}" 
                               onchange="updateMenuItem(${index}, 'name', this.value)" placeholder="اسم الصنف">
                        <input type="number" class="form-control" value="${item.price}" 
                               onchange="updateMenuItem(${index}, 'price', parseInt(this.value))" placeholder="السعر">
                    </div>
                    <div class="form-group" style="margin-top: 10px;">
                        <textarea class="form-control" rows="2" onchange="updateMenuItem(${index}, 'description', this.value)"
                                  placeholder="وصف الصنف">${item.description}</textarea>
                    </div>
                    <div class="form-row">
                        <input type="text" class="form-control" value="${item.image}" 
                               onchange="updateMenuItem(${index}, 'image', this.value)" placeholder="رابط الصورة">
                        <select class="form-control" onchange="updateMenuItem(${index}, 'category', this.value)">
                            ${restaurantData.categories.filter(c => c.id !== 'all').map(c => 
                                `<option value="${c.id}" ${item.category === c.id ? 'selected' : ''}>${c.name}</option>`
                            ).join('')}
                        </select>
                    </div>
                    <div class="form-group" style="margin-top: 10px;">
                        <input type="text" class="form-control" value="${item.tags.join(', ')}" 
                               onchange="updateMenuItem(${index}, 'tags', this.value.split(',').map(t => t.trim()))" 
                               placeholder="الوسوم (افصل بينها بفواصل)">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" value="${item.badge || ''}" 
                               onchange="updateMenuItem(${index}, 'badge', this.value)" placeholder="شعار خاص (اختياري)">
                    </div>
                `;
                container.appendChild(itemElement);
            });
        }

        function loadCategoriesControl() {
            const container = document.getElementById('categoriesList');
            container.innerHTML = '';
            
            restaurantData.categories.filter(c => c.id !== 'all').forEach((category, index) => {
                const categoryElement = document.createElement('div');
                categoryElement.className = 'menu-item-control';
                categoryElement.innerHTML = `
                    <div class="menu-item-header">
                        <h4>${category.name}</h4>
                        <button class="btn btn-danger btn-small" onclick="deleteCategory(${index + 1})" 
                                ${category.id === 'all' ? 'disabled' : ''}>
                            <i class="fas fa-trash"></i> حذف
                        </button>
                    </div>
                    <div class="form-row">
                        <input type="text" class="form-control" value="${category.name}" 
                               onchange="updateCategory(${index + 1}, 'name', this.value)" placeholder="اسم القسم">
                        <input type="text" class="form-control" value="${category.icon}" 
                               onchange="updateCategory(${index + 1}, 'icon', this.value)" placeholder="أيقونة FontAwesome">
                    </div>
                `;
                container.appendChild(categoryElement);
            });
        }

        // ========== تحديث البيانات ==========
        function updateMenuItem(index, field, value) {
            if (field === 'price') {
                restaurantData.menuItems[index][field] = parseInt(value) || 0;
            } else {
                restaurantData.menuItems[index][field] = value;
            }
        }

        function updateCategory(index, field, value) {
            restaurantData.categories[index][field] = value;
        }

        // ========== إضافة عناصر جديدة ==========
        function addNewMenuItem() {
            const newItem = {
                id: restaurantData.menuItems.length + 1,
                name: "صنف جديد",
                description: "وصف الصنف الجديد",
                price: 10000,
                image: "https://images.unsplash.com/photo-1578474846511-04ba529f0b88?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                category: "main",
                tags: ["جديد"],
                badge: ""
            };
            
            restaurantData.menuItems.push(newItem);
            loadMenuItemsControl();
        }

        function addNewCategory() {
            const newId = 'cat' + (restaurantData.categories.length + 1);
            const newCategory = {
                id: newId,
                name: "قسم جديد",
                icon: "fas fa-star"
            };
            
            restaurantData.categories.push(newCategory);
            loadCategoriesControl();
        }

        // ========== حذف العناصر ==========
        function deleteMenuItem(index) {
            if (confirm('هل أنت متأكد من حذف هذا الصنف؟')) {
                restaurantData.menuItems.splice(index, 1);
                loadMenuItemsControl();
            }
        }

        function deleteCategory(index) {
            if (restaurantData.categories[index].id === 'all') {
                alert('لا يمكن حذف قسم "كل الأصناف"');
                return;
            }
            
            if (confirm('هل أنت متأكد من حذف هذا القسم؟')) {
                restaurantData.categories.splice(index, 1);
                loadCategoriesControl();
            }
        }

        // ========== حفظ التعديلات ==========
        function saveRestaurantInfo() {
            restaurantData.name = document.getElementById('controlRestaurantName').value;
            restaurantData.tagline = document.getElementById('controlTagline').value;
            restaurantData.phone = document.getElementById('controlPhone').value;
            restaurantData.location = document.getElementById('controlLocation').value;
            restaurantData.hours = document.getElementById('controlHours').value;
            restaurantData.delivery = document.getElementById('controlDelivery').value;
            
            saveData();
            updateDisplay();
            alert('تم حفظ معلومات المطعم بنجاح!');
        }

        function saveMenuItems() {
            restaurantData.currency = document.getElementById('controlCurrency').value;
            saveData();
            updateDisplay();
            alert('تم حفظ الأصناف بنجاح!');
        }

        function saveCategories() {
            saveData();
            updateDisplay();
            alert('تم حفظ الأقسام بنجاح!');
        }

        function updateQRCode() {
            restaurantData.menuUrl = document.getElementById('controlMenuUrl').value;
            saveData();
            createQRCode();
            alert('تم تحديث رابط الباركود!');
        }

        // ========== إعادة التعيين ==========
        function resetToDefault() {
            if (confirm('هل تريد حقاً إعادة التعيين إلى الإعدادات الافتراضية؟ سيتم فقدان جميع التعديلات.')) {
                localStorage.removeItem('restaurantMenuData');
                restaurantData = { ...defaultRestaurantData };
                saveData();
                updateDisplay();
                loadControlData();
                alert('تمت إعادة التعيين بنجاح!');
            }
        }

        // ========== الوظائف الرئيسية ==========
        function updateDisplay() {
            // تحديث معلومات المطعم
            document.getElementById('restaurantName').textContent = restaurantData.name;
            document.getElementById('tagline').textContent = restaurantData.tagline;
            document.getElementById('phone').textContent = restaurantData.phone;
            document.getElementById('location').textContent = restaurantData.location;
            document.getElementById('hours').textContent = restaurantData.hours;
            document.getElementById('delivery').textContent = restaurantData.delivery;
            document.getElementById('menuLinkText').textContent = restaurantData.menuUrl;
            
            // تحديث التبويبات
            updateTabs();
            
            // تحديث القائمة
            displayMenuItems('all');
            
            // تحديث الباركود
            createQRCode();
        }

        function updateTabs() {
            const tabsContainer = document.getElementById('tabsContainer');
            tabsContainer.innerHTML = '';
            
            restaurantData.categories.forEach(category => {
                const tab = document.createElement('div');
                tab.className = 'tab';
                tab.innerHTML = `
                    <i class="${category.icon}"></i>
                    ${category.name}
                `;
                tab.dataset.category = category.id;
                tab.addEventListener('click', () => filterMenu(category.id));
                tabsContainer.appendChild(tab);
            });
            
            // تفعيل أول تبويب
            if (document.querySelector('.tab')) {
                document.querySelector('.tab').classList.add('active');
            }
        }

        function displayMenuItems(categoryId) {
            const container = document.getElementById('menuContainer');
            container.innerHTML = '';
            
            // تحديث التبويب النشط
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
                if(tab.dataset.category === categoryId) {
                    tab.classList.add('active');
                }
            });
            
            // تصفية العناصر حسب القسم
            let itemsToShow = restaurantData.menuItems;
            if(categoryId !== 'all') {
                itemsToShow = restaurantData.menuItems.filter(item => item.category === categoryId);
            }
            
            // إنشاء العناصر
            itemsToShow.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.className = 'menu-item fade-in';
                
                const imageUrl = item.image || 'https://images.unsplash.com/photo-1578474846511-04ba529f0b88?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80';
                
                menuItem.innerHTML = `
                    <div class="image-container">
                        <img src="${imageUrl}" alt="${item.name}" class="item-image" 
                             onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1578474846511-04ba529f0b88?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80';">
                        ${item.badge ? `<span class="badge">${item.badge}</span>` : ''}
                    </div>
                    <div class="item-content">
                        <div class="item-header">
                            <h3 class="item-name">${item.name}</h3>
                            <div class="item-price">
                                ${formatPrice(item.price)} <span class="currency">${restaurantData.currency}</span>
                            </div>
                        </div>
                        <p class="item-desc">${item.description}</p>
                        <div class="item-tags">
                            ${item.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                `;
                container.appendChild(menuItem);
            });
            
            // إذا لم توجد عناصر
            if(itemsToShow.length === 0) {
                container.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 50px;">
                        <i class="fas fa-utensils" style="font-size: 4rem; color: #D4AF37; margin-bottom: 20px;"></i>
                        <h3 style="color: #8B4513;">لا توجد أصناف في هذا القسم حالياً</h3>
                        <p>يمكنك إضافة أصناف جديدة من لوحة التحكم</p>
                    </div>
                `;
            }
        }

        function formatPrice(price) {
            return price.toLocaleString('ar-IQ');
        }

        function filterMenu(categoryId) {
            displayMenuItems(categoryId);
        }

        function createQRCode() {
            const qrContainer = document.getElementById('qrcode');
            const url = restaurantData.menuUrl;
            
            try {
                const qrcode = new QRCode({
                    content: url,
                    padding: 4,
                    width: 200,
                    height: 200,
                    color: "#000000",
                    background: "#ffffff",
                    ecl: "M"
                });
                
                qrContainer.innerHTML = qrcode.svg();
                
                const title = document.createElement('div');
                title.style.cssText = 'text-align: center; margin-top: 10px; font-size: 0.9rem; color: #666;';
                title.textContent = restaurantData.name;
                qrContainer.appendChild(title);
                
            } catch (error) {
                console.error('خطأ في إنشاء الباركود:', error);
                qrContainer.innerHTML = `
                    <div style="
                        width: 200px; 
                        height: 200px; 
                        background: #f8f9fa; 
                        display: flex; 
                        flex-direction: column; 
                        align-items: center; 
                        justify-content: center; 
                        border-radius: 10px;
                        border: 2px dashed #D4AF37;
                        padding: 20px;
                        text-align: center;
                    ">
                        <i class="fas fa-qrcode" style="font-size: 4rem; color: #8B4513; margin-bottom: 15px;"></i>
                        <div style="font-family: monospace; font-size: 0.8rem; word-break: break-all; color: #666;">
                            ${url.replace('https://', '')}
                        </div>
                    </div>
                `;
            }
        }

        function copyMenuLink() {
            const link = restaurantData.menuUrl;
            navigator.clipboard.writeText(link).then(() => {
                const btn = document.querySelector('.copy-btn');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> تم النسخ!';
                btn.style.background = 'linear-gradient(135deg, #228B22, #1E7A1E)';
                
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.style.background = 'linear-gradient(135deg, var(--gold), var(--dark-gold))';
                }, 2000);
            }).catch(err => {
                console.error('خطأ في النسخ:', err);
                alert('تعذر نسخ الرابط. يمكنك نسخه يدوياً: ' + link);
            });
        }

        // ========== تهيئة التطبيق ==========
        document.addEventListener('DOMContentLoaded', function() {
            // تحميل البيانات المحفوظة
            loadSavedData();
            
            // تحديث العرض
            updateDisplay();
            
            // إضافة مستمع للزر Enter في حقل كلمة المرور
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkPassword();
                }
            });
            
            console.log('🌟 لوحة التحكم السرية جاهزة!');
            console.log('🔑 كلمة المرور: karam9');
            console.log('💡 انقر على زر المستخدم السري في الزاوية اليسرى العليا');
        });
    </script>
</body>
</html>